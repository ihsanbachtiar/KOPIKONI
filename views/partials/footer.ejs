</main> </div> <script src="/vendor/aos/aos.js"></script>
  
  <script>
    // Inisialisasi AOS (dengan 'scrollContainer' untuk 'main')
    AOS.init({
      scrollContainer: '#main-content-area',
      duration: 800, 
      once: true,    
      mirror: false, 
    });

    // Helper: Fungsi untuk format mata uang
    function formatCurrency(amount) {
      // Menggunakan Intl.NumberFormat untuk format Rupiah tanpa desimal
      return new Intl.NumberFormat('id-ID', {
          style: 'currency',
          currency: 'IDR',
          maximumFractionDigits: 0
      }).format(amount);
    }

    const menuDropdownToggle = document.getElementById('menuDropdownToggle');
    const menuDropdownContent = document.getElementById('menuDropdownContent');
    const menuDropdownArrow = document.getElementById('menuDropdownArrow');

    // Cek jika elemen ada (aman untuk admin & customer)
    if (menuDropdownToggle && menuDropdownContent && menuDropdownArrow) {
      menuDropdownToggle.addEventListener('click', function() {
        // Toggle (buka/tutup) class 'hidden' pada konten dropdown
        menuDropdownContent.classList.toggle('hidden');
        
        // Putar panah (pastikan 'rotate-180' ada di output.css Anda)
        menuDropdownArrow.classList.toggle('rotate-180'); 
      });
    }
    
    // --- MODAL KUANTITAS ---
    const quantityModal = document.getElementById('quantityModal');
    const closeQuantityModalBtn = document.getElementById('closeQuantityModal');
    const addToCartButtons = document.querySelectorAll('.add-to-cart-btn');

    const modalMenuId = document.getElementById('modal-menu-id');
    const modalMenuName = document.getElementById('modal-menu-name');
    const modalMenuPriceDisplay = document.getElementById('modal-menu-price-display');
    const modalMenuImage = document.getElementById('modal-menu-image');
    const modalQuantityInput = document.getElementById('modal-quantity');
    const modalTotalDisplay = document.getElementById('modal-total-display');
    const decreaseQuantityBtn = document.getElementById('decreaseQuantity');
    const increaseQuantityBtn = document.getElementById('increaseQuantity');

    let currentItemPrice = 0; // Menyimpan harga item yang sedang dipilih

    // Fungsi untuk mengupdate total harga di modal
    const updateModalTotal = () => {
      const quantity = parseInt(modalQuantityInput.value) || 0;
      const total = quantity * currentItemPrice;
      modalTotalDisplay.textContent = formatCurrency(total);
      decreaseQuantityBtn.disabled = quantity <= 1;
    };

    // Fungsi utama untuk membuka modal
    const openModal = (menu) => {
      currentItemPrice = parseFloat(menu.price); // Pastikan ini angka float
      
      modalMenuId.value = menu.id;
      modalMenuName.textContent = menu.name;
      modalMenuPriceDisplay.textContent = formatCurrency(menu.price);
      modalMenuImage.src = menu.image || 'https://placehold.co/80'; // Fallback image
      modalQuantityInput.value = 1; // Reset kuantitas ke 1
      
      updateModalTotal(); // Hitung total awal
      quantityModal.classList.remove('hidden');
    };

    // Event listener untuk tombol 'Tambah ke Keranjang'
    addToCartButtons.forEach(button => {
      button.addEventListener('click', (event) => {
        const menu = {
          id: button.dataset.menuId,
          name: button.dataset.menuName,
          price: button.dataset.menuPrice,
          image: button.dataset.menuImage
        };
        openModal(menu);
      });
    });

    // Event listeners untuk tombol +/-
    if (decreaseQuantityBtn && increaseQuantityBtn) {
      decreaseQuantityBtn.addEventListener('click', () => {
        let quantity = parseInt(modalQuantityInput.value);
        if (quantity > 1) {
          modalQuantityInput.value = quantity - 1;
          updateModalTotal();
        }
      });
      increaseQuantityBtn.addEventListener('click', () => {
        let quantity = parseInt(modalQuantityInput.value);
        modalQuantityInput.value = quantity + 1;
        updateModalTotal();
      });
    }

    // Event listener untuk input kuantitas dan tutup modal
    if (modalQuantityInput) {
      modalQuantityInput.addEventListener('input', updateModalTotal);
    }
    if (closeQuantityModalBtn) {
      closeQuantityModalBtn.addEventListener('click', () => quantityModal.classList.add('hidden'));
    }
    if (quantityModal) {
      quantityModal.addEventListener('click', (e) => {
        if (e.target === quantityModal) {
          quantityModal.classList.add('hidden');
        }
      });
    }


    const checkoutPopupBtn = document.getElementById('checkout-popup-btn');
    const checkoutModal = document.getElementById('checkout-modal');
    const closeModalBtn = document.getElementById('close-modal-btn');
    const closeModalBg = document.getElementById('checkout-modal-bg'); // Tambahkan ID ini di modal bg

    if (checkoutPopupBtn && checkoutModal && closeModalBtn) {
      checkoutPopupBtn.addEventListener('click', () => {
        checkoutModal.classList.remove('hidden');
      });
      
      const closeFn = () => {
        checkoutModal.classList.add('hidden');
      };
      
      closeModalBtn.addEventListener('click', closeFn);
      if (closeModalBg) {
        closeModalBg.addEventListener('click', closeFn);
      }
      
      // Versi lama Anda:
      // checkoutModal.addEventListener('click', (e) => {
      //   if (e.target === checkoutModal) {
      //     checkoutModal.classList.add('hidden');
      //   }
      // });
    }

    // Script untuk notifikasi sukses (di halaman keranjang)
    const successNotification = document.getElementById('success-notification');
    const closeNotificationBtn = document.getElementById('close-notification-btn');

    const closeNotif = () => {
      if (successNotification) {
        successNotification.style.transition = 'opacity 0.5s ease';
        successNotification.style.opacity = '0';
        setTimeout(() => {
          successNotification.remove();
        }, 500);
      }
    };

    /* =======================================================
       SCRIPT BARU UNTUK TOGGLE DETAIL RIWAYAT PESANAN
       =======================================================
    */
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.order-toggle-btn').forEach(button => {
            button.addEventListener('click', function() {
                const orderId = this.dataset.orderId;
                const detailsContent = document.getElementById(`order-details-${orderId}`);
                const arrowIcon = this.querySelector('.order-arrow-icon');

                if (detailsContent && arrowIcon) {
                    detailsContent.classList.toggle('hidden');
                    arrowIcon.classList.toggle('rotate-180');
                }
            });
        });
    });
// Script untuk menyembunyikan notifikasi flash message setelah beberapa detik
            const flashNotification = document.getElementById('flash-notification');
            if (flashNotification) {
                setTimeout(() => {
                    flashNotification.classList.add('hidden');
                }, 5000); // Sembunyikan setelah 5 detik
            }
    // Sidebar toggle (jika ada, pastikan id tombol sudah benar di header/sidebar)
    const sidebar = document.getElementById('sidebar');
    const sidebarToggleBtn = document.getElementById('sidebar-toggle-btn'); 
    const sidebarCloseBtn = document.getElementById('sidebar-close-btn');

    if (sidebarToggleBtn) {
      sidebarToggleBtn.addEventListener('click', () => {
        sidebar.classList.toggle('-translate-x-full');
      });
    }

    if (sidebarCloseBtn) {
      sidebarCloseBtn.addEventListener('click', () => {
        sidebar.classList.add('-translate-x-full');
      });
    }

    // Category menu toggle
    const categoryToggle = document.getElementById('category-toggle');
    const categoryMenu = document.getElementById('category-menu');
    if (categoryToggle && categoryMenu) {
      categoryToggle.addEventListener('click', () => {
        categoryMenu.classList.toggle('hidden');
        categoryToggle.querySelector('svg').classList.toggle('rotate-180');
      });
    }

    // --- SCRIPT BARU UNTUK TOGGLE DETAIL RIWAYAT PESANAN ---
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.order-toggle-btn').forEach(button => {
        button.addEventListener('click', function() {
            const orderId = this.dataset.orderId;
            const detailsContent = document.getElementById(`order-details-${orderId}`);
            const arrowIcon = this.querySelector('.order-arrow-icon');

            if (detailsContent && arrowIcon) {
                detailsContent.classList.toggle('hidden');
                arrowIcon.classList.toggle('rotate-180');
            }
        });
    });

    // Script untuk notifikasi sukses (jika ada di halaman ini)
    const messageNotification = document.getElementById('message-notification');
    if (messageNotification) {
        setTimeout(() => {
            messageNotification.classList.add('hidden');
        }, 5000); 
    }
});


    // --- SCRIPT LAIN (Dropdown, Checkout, Notifikasi) ---
    // (Tambahkan script untuk dropdown sidebar, checkout modal, dan notifikasi di sini)
  </script>

</body>
</html>